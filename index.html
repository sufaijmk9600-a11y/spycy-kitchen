<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPICY KITCHEN - Luxury Party Food Business</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .luxury-gradient { 
            background: linear-gradient(135deg, #309774 0%, #2A8065 100%);
        }
        
        .luxury-gold-gradient {
            background: linear-gradient(135deg, #309774 0%, #2A8065 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .dark-glass {
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .menu-card { 
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .menu-card:hover { 
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .luxury-button {
            background: linear-gradient(135deg, #309774 0%, #2A8065 100%);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 10px 25px -5px rgba(48, 151, 116, 0.4);
        }
        
        .luxury-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -5px rgba(48, 151, 116, 0.6);
        }
        
        .gold-button {
            background: linear-gradient(135deg, #309774 0%, #2A8065 100%);
            box-shadow: 0 10px 25px -5px rgba(48, 151, 116, 0.4);
        }
        
        .gold-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 40px -5px rgba(48, 151, 116, 0.6);
        }
        
        .input-luxury {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .input-luxury:focus {
            background: rgba(255, 255, 255, 0.95);
            border-color: #309774;
            box-shadow: 0 0 0 3px rgba(48, 151, 116, 0.1);
        }
        
        .modal-luxury {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(40px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .category-pill {
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .category-pill.active {
            background: linear-gradient(135deg, #309774 0%, #2A8065 100%);
            box-shadow: 0 8px 25px -8px rgba(48, 151, 116, 0.6);
        }
        
        .category-pill:not(.active) {
            background: rgba(255, 255, 255, 0.7);
            color: #374151;
        }
        
        .luxury-shadow {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        body {
            background: linear-gradient(135deg, rgba(248, 249, 250, 0.95) 0%, rgba(233, 236, 239, 0.95) 100%), 
                        url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZGVmcz4KPHN0eWxlPgouYmFja2dyb3VuZCB7CiAgZmlsbDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzFhMWEyZSAwJSwgIzE2MjEzZSAxMDAlKTsKfQouY29va2luZy1zY2VuZSB7CiAgZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogIHN0cm9rZTogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpOwogIHN0cm9rZS13aWR0aDogMjsKfQouZmFkZWQgewogIG9wYWNpdHk6IDAuMzsKfQo8L3N0eWxlPgo8L2RlZnM+CjxyZWN0IHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEwODAiIGNsYXNzPSJiYWNrZ3JvdW5kIi8+CjwhLS0gS2l0Y2hlbiBDb3VudGVyIC0tPgo8cmVjdCB4PSIxMDAiIHk9IjcwMCIgd2lkdGg9IjE3MjAiIGhlaWdodD0iMjAwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgcng9IjIwIi8+CjwhLS0gQ29va2luZyBQb3RzIC0tPgo8Y2lyY2xlIGN4PSIzMDAiIGN5PSI2NTAiIHI9IjgwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8Y2lyY2xlIGN4PSI2MDAiIGN5PSI2MDAiIHI9IjEwMCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSI5MDAiIGN5PSI2MjAiIHJ4PSIxMjAiIHJ5PSI4MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBTcGljZSBCb3dscy0tPgo8Y2lyY2xlIGN4PSIxMjAwIiBjeT0iNjgwIiByPSI0MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxMzUwIiBjeT0iNjkwIiByeD0iNTAiIHJ5PSIzMCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxNTAwIiBjeT0iNjcwIiByeD0iNDUiIHJ5PSIzNSIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBXb21lbiBGaWd1cmVzIC0tPgo8ZWxsaXBzZSBjeD0iNDAwIiBjeT0iNTAwIiByeD0iNDAiIHJ5PSI4MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSI4MDAiIGN5PSI0ODAiIHJ4PSI0NSIgcnk9Ijg1IiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8ZWxsaXBzZSBjeD0iMTIwMCIgY3k9IjQ2MCIgcng9IjQyIiByeT0iODIiIGNsYXNzPSJjb29raW5nLXNjZW5lIGZhZGVkIi8+CjwhLS0gSGVhZHNjYXJmcyAtLT4KPGV4bGxpcHNlIGN4PSI0MDAiIGN5PSI0MDAiIHJ4PSI1MCIgcnk9IjMwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8ZWxsaXBzZSBjeD0iODAwIiBjeT0iMzgwIiByeD0iNTUiIHJ5PSIzMiIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxMjAwIiBjeT0iMzYwIiByeD0iNTIiIHJ5PSIzMSIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBTdGVhbSBmcm9tIENvb2tpbmcgLS0+CjxwYXRoIGQ9Ik0zMDAgNTUwIFEzMjAgNTIwIDM0MCA1NTAgUTM2MCA1MjAgMzgwIDU1MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiIGZpbGw9Im5vbmUiLz4KPHA+dGggZD0iTTYwMCA1MDAgUTYzMCA0NzAgNjYwIDUwMCBRNjkwIDQ3MCA3MjAgNTAwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgZmlsbD0ibm9uZSIvPgo8cGF0aCBkPSJNOTAwIDUyMCBROTMwIDQ5MCA5NjAgNTIwIFE5OTAgNDkwIDEwMjAgNTIwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgZmlsbD0ibm9uZSIvPgo8IS0tIERlY29yYXRpdmUgRWxlbWVudHMgLS0+CjxyZWN0IHg9IjUwIiB5PSI4MDAiIHdpZHRoPSIxODIwIiBoZWlnaHQ9IjEwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgcng9IjUiLz4KPHN2Zz4=');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        /* Malayalam font support */
        .malayalam-text {
            font-family: 'Noto Sans Malayalam', 'Manjari', 'Meera', 'Rachana', sans-serif;
            font-weight: 500;
            line-height: 1.6;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Header -->
    <header class="luxury-gradient text-white p-4 sm:p-6 sticky top-0 z-50 luxury-shadow">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-xl sm:text-2xl backdrop-blur-lg">üçΩÔ∏è</div>
                <div>
                    <h1 class="text-xl sm:text-2xl font-bold tracking-tight">SPICY KITCHEN</h1>
                    <p class="text-xs sm:text-sm opacity-90 font-light malayalam-text">A fully home made solution for your party üçΩÔ∏è - ‡¥µ‡¥≥‡¥™‡¥ü‡µç‡¥ü‡¥£‡¥Ç</p>
                </div>
            </div>
            <div class="text-left sm:text-right w-full sm:w-auto">
                <p class="text-xs opacity-75 mb-2 malayalam-text">We serve inside Kannur only</p>
                <button id="adminBtn" class="glass-effect w-10 h-10 sm:w-auto sm:px-6 sm:py-3 rounded-2xl text-sm font-bold hover:bg-white hover:bg-opacity-30 transition-all duration-300 flex items-center justify-center">
                    <span class="sm:hidden">A</span>
                    <span class="hidden sm:inline">Admin Panel</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="p-4 sm:p-6">
        <!-- Cart Summary -->
        <div class="glass-effect p-4 sm:p-6 rounded-3xl mb-6 luxury-shadow">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 luxury-gradient rounded-2xl flex items-center justify-center text-white font-bold">
                        <span id="cartCount">0</span>
                    </div>
                    <span class="text-gray-800 font-medium">Items in Cart</span>
                </div>
                <button id="viewCart" class="luxury-button text-white px-4 sm:px-6 py-2 sm:py-3 rounded-2xl font-medium w-full sm:w-auto">View Cart</button>
            </div>
        </div>

        <!-- Menu Categories -->
        <div class="flex gap-3 mb-6 overflow-x-auto pb-2">
            <button class="category-filter category-pill active text-white px-6 py-3 rounded-2xl whitespace-nowrap font-medium" data-category="all">All Items</button>
            <button class="category-filter category-pill px-6 py-3 rounded-2xl whitespace-nowrap font-medium" data-category="appetizers">Appetizers</button>
            <button class="category-filter category-pill px-6 py-3 rounded-2xl whitespace-nowrap font-medium" data-category="mains">Main Course</button>
            <button class="category-filter category-pill px-6 py-3 rounded-2xl whitespace-nowrap font-medium" data-category="desserts">Desserts</button>
            <button class="category-filter category-pill px-6 py-3 rounded-2xl whitespace-nowrap font-medium" data-category="beverages">Beverages</button>
        </div>

        <!-- Menu Items -->
        <div id="menuItems" class="space-y-6">
            <!-- Menu items will be displayed here -->
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden backdrop-blur-sm">
        <div class="modal-luxury h-full overflow-y-auto m-2 sm:m-4 rounded-3xl">
            <div class="p-4 sm:p-6 border-b border-white border-opacity-20 luxury-gradient text-white rounded-t-3xl">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-sm sm:text-base">‚öôÔ∏è</div>
                        <h3 class="text-lg sm:text-xl font-semibold">Admin Panel</h3>
                    </div>
                    <button id="closeAdmin" class="w-8 h-8 sm:w-10 sm:h-10 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-white text-lg sm:text-xl hover:bg-opacity-30 transition-all">&times;</button>
                </div>
            </div>
            <div class="p-4 sm:p-6">
                <!-- Add Menu Item Form -->
                <div class="glass-effect rounded-3xl p-4 sm:p-6 mb-6 luxury-shadow">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-6 h-6 sm:w-8 sm:h-8 luxury-gradient rounded-xl flex items-center justify-center text-white text-sm sm:text-base">+</div>
                        <h3 class="text-lg sm:text-xl font-semibold text-gray-800">Add New Menu Item</h3>
                    </div>
                    <form id="menuForm" class="space-y-4">
                        <input type="text" id="itemName" placeholder="Item Name" class="w-full p-3 sm:p-4 input-luxury rounded-2xl focus:outline-none text-sm sm:text-base" required>
                        <textarea id="itemDescription" placeholder="Description" class="w-full p-3 sm:p-4 input-luxury rounded-2xl h-20 sm:h-24 focus:outline-none resize-none text-sm sm:text-base" required></textarea>
                        <select id="itemCategory" class="w-full p-3 sm:p-4 input-luxury rounded-2xl focus:outline-none text-sm sm:text-base" required>
                            <option value="">Select Category</option>
                            <option value="appetizers">Appetizers</option>
                            <option value="mains">Main Course</option>
                            <option value="desserts">Desserts</option>
                            <option value="beverages">Beverages</option>
                        </select>
                        <div class="space-y-3">
                            <label class="block text-xs sm:text-sm font-semibold text-gray-700">Upload Photo</label>
                            <input type="file" id="itemPhoto" accept="image/*" class="w-full p-3 sm:p-4 input-luxury rounded-2xl focus:outline-none text-sm sm:text-base">
                            <div id="photoPreview" class="hidden">
                                <img id="previewImg" class="w-20 h-20 sm:w-24 sm:h-24 object-cover rounded-2xl border-2 border-white luxury-shadow">
                            </div>
                        </div>
                        <button type="submit" class="w-full luxury-button text-white py-3 sm:py-4 rounded-2xl font-semibold text-sm sm:text-base">Add Menu Item</button>
                    </form>
                </div>

                <!-- Generate Quotation -->
                <div class="glass-effect rounded-3xl p-6 mb-6 luxury-shadow">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 luxury-gold-gradient rounded-xl flex items-center justify-center text-white">üìÑ</div>
                        <h3 class="text-xl font-semibold text-gray-800">Generate Quotation</h3>
                    </div>
                    <div class="space-y-4">
                        <input type="text" id="customerName" placeholder="Customer Name" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                        <input type="tel" id="customerPhone" placeholder="Customer Phone" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                        <input type="text" id="deliveryAddress" placeholder="Delivery Address" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                        <input type="number" id="deliveryCharge" placeholder="Delivery Charge ($)" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                        <div id="quotationItems" class="space-y-3">
                            <!-- Quotation items will be added here -->
                        </div>
                        <div class="flex gap-3">
                            <select id="menuItemSelect" class="flex-1 p-3 input-luxury rounded-2xl focus:outline-none">
                                <option value="">Select from menu</option>
                            </select>
                            <button id="addFromMenu" class="luxury-button text-white px-6 py-3 rounded-2xl font-medium">Add</button>
                        </div>
                        <button id="addQuotationItem" class="w-full glass-effect text-gray-700 py-3 rounded-2xl hover:bg-white hover:bg-opacity-40 transition-all font-medium">+ Add Custom Item</button>
                        <button id="generatePDF" class="w-full gold-button text-white py-4 rounded-2xl font-semibold">Generate & Download PDF</button>
                    </div>
                </div>

                <!-- Background Photo Upload -->
                <div class="glass-effect rounded-3xl p-6 mb-6 luxury-shadow">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 luxury-gold-gradient rounded-xl flex items-center justify-center text-white">üñºÔ∏è</div>
                        <h3 class="text-xl font-semibold text-gray-800">Background Photo</h3>
                    </div>
                    <div class="space-y-4">
                        <div class="space-y-3">
                            <label class="block text-sm font-semibold text-gray-700">Upload Background Image</label>
                            <input type="file" id="backgroundPhoto" accept="image/*" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                            <div id="backgroundPreview" class="hidden">
                                <img id="backgroundPreviewImg" class="w-full h-32 object-cover rounded-2xl border-2 border-white luxury-shadow">
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <button id="uploadBackground" class="flex-1 luxury-button text-white py-3 rounded-2xl font-medium">Update Background</button>
                            <button id="resetBackground" class="flex-1 gold-button text-white py-3 rounded-2xl font-medium">Reset to Default</button>
                        </div>
                    </div>
                </div>

                <!-- Manage Menu Items -->
                <div class="glass-effect rounded-3xl p-6 luxury-shadow">
                    <div class="flex items-center space-x-3 mb-4">
                        <div class="w-8 h-8 luxury-gradient rounded-xl flex items-center justify-center text-white">üìã</div>
                        <h3 class="text-xl font-semibold text-gray-800">Manage Menu Items</h3>
                    </div>
                    <div id="adminMenuList" class="space-y-3">
                        <!-- Admin menu items will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden backdrop-blur-sm">
        <div class="modal-luxury h-full overflow-y-auto m-4 rounded-3xl">
            <div class="p-6 border-b border-white border-opacity-20 luxury-gradient text-white rounded-t-3xl">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center">üõí</div>
                        <h3 class="text-xl font-semibold">Your Cart</h3>
                    </div>
                    <button id="closeCart" class="w-10 h-10 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center text-white text-xl hover:bg-opacity-30 transition-all">&times;</button>
                </div>
            </div>
            <div class="p-6">
                <div id="cartItems" class="space-y-4 mb-6">
                    <!-- Cart items will be displayed here -->
                </div>
                <button id="requestQuotation" class="w-full gold-button text-white py-4 rounded-2xl font-semibold">Request Quotation via WhatsApp</button>
            </div>
        </div>
    </div>

    <!-- Quantity Modal -->
    <div id="quantityModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden backdrop-blur-sm flex items-center justify-center">
        <div class="modal-luxury mx-4 p-8 rounded-3xl luxury-shadow max-w-sm w-full">
            <h3 class="text-2xl font-semibold mb-2 text-center text-gray-800">Select Quantity</h3>
            <div class="text-center mb-6">
                <span id="selectedItemName" class="font-medium text-gray-600 text-lg"></span>
            </div>
            <div class="flex items-center justify-center gap-6 mb-8">
                <button id="decreaseQty" class="glass-effect text-gray-700 w-14 h-14 rounded-2xl text-2xl font-bold hover:bg-white hover:bg-opacity-40 transition-all">-</button>
                <input type="number" id="quantityInput" value="1" min="1" class="w-24 text-center text-2xl font-bold input-luxury rounded-2xl p-3 focus:outline-none">
                <button id="increaseQty" class="luxury-button text-white w-14 h-14 rounded-2xl text-2xl font-bold">+</button>
            </div>
            <div class="flex gap-4">
                <button id="cancelQty" class="flex-1 glass-effect text-gray-700 py-4 rounded-2xl font-semibold hover:bg-white hover:bg-opacity-40 transition-all">Cancel</button>
                <button id="confirmQty" class="flex-1 luxury-button text-white py-4 rounded-2xl font-semibold">Add to Cart</button>
            </div>
        </div>
    </div>

    <!-- Edit Item Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden backdrop-blur-sm flex items-center justify-center">
        <div class="modal-luxury mx-4 p-6 rounded-3xl luxury-shadow max-w-md w-full max-h-96 overflow-y-auto">
            <h3 class="text-xl font-semibold mb-6 text-gray-800 text-center">Edit Menu Item</h3>
            <form id="editForm" class="space-y-4">
                <input type="hidden" id="editItemId">
                <input type="text" id="editItemName" placeholder="Item Name" class="w-full p-4 input-luxury rounded-2xl focus:outline-none" required>
                <textarea id="editItemDescription" placeholder="Description" class="w-full p-4 input-luxury rounded-2xl h-24 focus:outline-none resize-none" required></textarea>
                <select id="editItemCategory" class="w-full p-4 input-luxury rounded-2xl focus:outline-none" required>
                    <option value="appetizers">Appetizers</option>
                    <option value="mains">Main Course</option>
                    <option value="desserts">Desserts</option>
                    <option value="beverages">Beverages</option>
                </select>
                <div class="space-y-3">
                    <label class="block text-sm font-semibold text-gray-700">Update Photo</label>
                    <input type="file" id="editItemPhoto" accept="image/*" class="w-full p-4 input-luxury rounded-2xl focus:outline-none">
                    <div id="editPhotoPreview">
                        <img id="editPreviewImg" class="w-24 h-24 object-cover rounded-2xl border-2 border-white luxury-shadow">
                    </div>
                </div>
                <div class="flex gap-4">
                    <button type="button" id="cancelEdit" class="flex-1 glass-effect text-gray-700 py-4 rounded-2xl font-semibold hover:bg-white hover:bg-opacity-40 transition-all">Cancel</button>
                    <button type="submit" class="flex-1 luxury-button text-white py-4 rounded-2xl font-semibold">Update Item</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="luxury-gradient text-white mt-8 sm:mt-12">
        <div class="p-4 sm:p-8">
            <!-- Party Orders Specialty -->
            <div class="text-center mb-6 sm:mb-8">
                <div class="glass-effect rounded-3xl p-4 sm:p-6 mb-4 sm:mb-6 luxury-shadow">
                    <h2 class="text-2xl sm:text-3xl font-bold mb-3 sm:mb-4">üçΩÔ∏è PARTY ORDERS SPECIALTY</h2>
                    <p class="text-sm sm:text-lg opacity-90 mb-2">We specialize in catering for parties, events, and large gatherings with authentic flavours</p>
                    <p class="text-lg sm:text-xl font-semibold malayalam-text">SPICY KITCHEN</p>
                    <p class="text-base sm:text-lg malayalam-text">Kannur / ‡¥µ‡¥≥‡¥™‡¥ü‡µç‡¥ü‡¥£‡¥Ç</p>
                </div>
            </div>

            <!-- Contact and Service Info -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
                <!-- Contact Us -->
                <div class="glass-effect rounded-3xl p-4 sm:p-6 text-center">
                    <h3 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4">üì± Contact Us</h3>
                    <a href="tel:+919633943583" class="text-xl sm:text-2xl font-bold hover:text-yellow-300 transition-colors">+919633943583</a>
                </div>

                <!-- Service Area -->
                <div class="glass-effect rounded-3xl p-4 sm:p-6 text-center">
                    <h3 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4">üìç Service Area</h3>
                    <p class="text-base sm:text-lg">Serving Kannur with authentic flavors</p>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="border-t border-white border-opacity-20 pt-4 sm:pt-6 text-center">
                <p class="mb-2 text-sm sm:text-base">¬© 2024 Spicy Kitchen. All rights reserved.</p>
                <p class="text-xs sm:text-sm opacity-75">üíª Design and developed by SUFAIJ - <a href="tel:+919961296000" class="hover:text-yellow-300 transition-colors">+919961296000</a></p>
            </div>
        </div>
    </footer>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBC3T0CKgAjhjV32VQvcrcN_FS-cSmLZsw",
            authDomain: "spycy-kitchen.firebaseapp.com",
            databaseURL: "https://spycy-kitchen-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "spycy-kitchen",
            storageBucket: "spycy-kitchen.firebasestorage.app",
            messagingSenderId: "244734462897",
            appId: "1:244734462897:web:d8ec521da0e18b84c38b90",
            measurementId: "G-GTSRPSQQKH"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();

        // Data storage
        let menuItems = [];
        let cart = [];
        let selectedItemForQuantity = null;
        let isLoading = false;

        // Firebase Functions
        function loadMenuItemsFromFirebase() {
            isLoading = true;
            showLoadingState();
            
            database.ref('menuItems').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    menuItems = Object.keys(data).map(key => ({
                        id: key,
                        ...data[key]
                    }));
                } else {
                    // Initialize with default items if database is empty
                    initializeDefaultItems();
                }
                isLoading = false;
                renderMenuItems();
                renderAdminMenu();
                hideLoadingState();
            }, (error) => {
                console.error('Error loading menu items:', error);
                isLoading = false;
                hideLoadingState();
                // Fallback to default items
                initializeDefaultItems();
                renderMenuItems();
                renderAdminMenu();
            });
        }

        function initializeDefaultItems() {
            const defaultItems = [
                {
                    name: "‡¥∏‡µç‡¥™‡µà‡¥∏‡¥ø ‡¥ö‡¥ø‡¥ï‡µç‡¥ï‡µª ‡¥¨‡¥ø‡¥∞‡¥ø‡¥Ø‡¥æ‡¥£‡¥ø",
                    description: "‡¥™‡¥∞‡¥Æ‡µç‡¥™‡¥∞‡¥æ‡¥ó‡¥§ ‡¥Æ‡¥∏‡¥æ‡¥≤‡¥ï‡¥≥‡µÅ‡¥Ç ‡¥π‡µÜ‡µº‡¥¨‡µÅ‡¥ï‡¥≥‡µÅ‡¥Ç ‡¥ö‡µá‡µº‡¥§‡µç‡¥§‡µç ‡¥™‡¥æ‡¥ï‡¥Ç ‡¥ö‡µÜ‡¥Ø‡µç‡¥§ ‡¥∏‡µÅ‡¥ó‡¥®‡µç‡¥ß‡¥Æ‡µÅ‡¥≥‡µç‡¥≥ ‡¥¨‡¥æ‡¥∏‡µç‡¥Æ‡¥§‡¥ø ‡¥Ö‡¥∞‡¥ø‡¥Ø‡µÅ‡¥Ç ‡¥ü‡µÜ‡µª‡¥°‡µº ‡¥ö‡¥ø‡¥ï‡µç‡¥ï‡µª ‡¥ï‡¥∑‡¥£‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥Ç. ‡¥™‡¥æ‡µº‡¥ü‡µç‡¥ü‡¥ø‡¥ï‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥Ö‡¥®‡µÅ‡¥Ø‡µã‡¥ú‡µç‡¥Ø‡¥Ç!",
                    category: "mains",
                    image: "üçõ"
                },
                {
                    name: "‡¥ï‡µç‡¥∞‡¥ø‡¥∏‡µç‡¥™‡¥ø ‡¥∏‡¥Æ‡µã‡¥∏ (50 ‡¥é‡¥£‡µç‡¥£‡¥Ç)",
                    description: "‡¥Æ‡¥∏‡¥æ‡¥≤ ‡¥ö‡µá‡µº‡¥§‡µç‡¥§ ‡¥â‡¥∞‡µÅ‡¥≥‡¥ï‡µç‡¥ï‡¥ø‡¥¥‡¥ô‡µç‡¥ô‡µÅ‡¥Ç ‡¥™‡¥Ø‡¥±‡µÅ‡¥Ç ‡¥®‡¥ø‡¥±‡¥ö‡µç‡¥ö ‡¥∏‡µç‡¥µ‡µº‡¥£‡µç‡¥£ ‡¥®‡¥ø‡¥±‡¥§‡µç‡¥§‡¥ø‡¥≤‡µÅ‡¥≥‡µç‡¥≥ ‡¥µ‡¥±‡µÅ‡¥§‡µç‡¥§ ‡¥™‡µá‡¥∏‡µç‡¥ü‡µç‡¥∞‡¥ø‡¥ï‡µæ. ‡¥Æ‡¥ø‡¥ï‡¥ö‡µç‡¥ö ‡¥™‡¥æ‡µº‡¥ü‡µç‡¥ü‡¥ø ‡¥∏‡µç‡¥±‡µç‡¥±‡¥æ‡µº‡¥ü‡µç‡¥ü‡µº!",
                    category: "appetizers",
                    image: "ü•ü"
                },
                {
                    name: "‡¥Æ‡¥æ‡¥ô‡µç‡¥ô‡µã ‡¥≤‡¥∏‡µç‡¥∏‡¥ø (5 ‡¥≤‡¥ø‡¥±‡µç‡¥±‡µº)",
                    description: "‡¥Æ‡¥ß‡µÅ‡¥∞‡¥Æ‡µÅ‡¥≥‡µç‡¥≥ ‡¥Æ‡¥æ‡¥ô‡µç‡¥ô‡¥æ ‡¥™‡µæ‡¥™‡µç‡¥™‡µç ‡¥ö‡µá‡µº‡¥§‡µç‡¥§ ‡¥â‡¥®‡µç‡¥Æ‡µá‡¥∑‡¥¶‡¥æ‡¥Ø‡¥ï‡¥Æ‡¥æ‡¥Ø ‡¥§‡µà‡¥∞‡µç ‡¥Ö‡¥ü‡¥ø‡¥∏‡µç‡¥•‡¥æ‡¥®‡¥Æ‡¥æ‡¥ï‡µç‡¥ï‡¥ø‡¥Ø‡µÅ‡¥≥‡µç‡¥≥ ‡¥™‡¥æ‡¥®‡µÄ‡¥Ø‡¥Ç. 20-25 ‡¥™‡µá‡µº‡¥ï‡µç‡¥ï‡µç ‡¥Æ‡¥§‡¥ø.",
                    category: "beverages",
                    image: "ü•§"
                }
            ];
            
            defaultItems.forEach(item => {
                const newRef = database.ref('menuItems').push();
                newRef.set(item);
            });
        }

        function saveMenuItemToFirebase(item) {
            return new Promise((resolve, reject) => {
                const newRef = database.ref('menuItems').push();
                newRef.set(item)
                    .then(() => resolve(newRef.key))
                    .catch(reject);
            });
        }

        function updateMenuItemInFirebase(id, item) {
            return database.ref(`menuItems/${id}`).set(item);
        }

        function deleteMenuItemFromFirebase(id) {
            return database.ref(`menuItems/${id}`).remove();
        }

        function uploadImageToFirebase(file, path) {
            return new Promise((resolve, reject) => {
                const storageRef = storage.ref().child(path);
                const uploadTask = storageRef.put(file);
                
                uploadTask.on('state_changed',
                    (snapshot) => {
                        // Progress function
                        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                        console.log('Upload is ' + progress + '% done');
                    },
                    (error) => {
                        reject(error);
                    },
                    () => {
                        uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                            resolve(downloadURL);
                        });
                    }
                );
            });
        }

        function showLoadingState() {
            const container = document.getElementById('menuItems');
            container.innerHTML = `
                <div class="text-center py-12">
                    <div class="w-16 h-16 border-4 border-green-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                    <p class="text-gray-600 text-lg">Loading menu items...</p>
                </div>
            `;
        }

        function hideLoadingState() {
            // Loading state will be replaced by renderMenuItems()
        }

        // Initialize app
        function init() {
            loadSavedBackground();
            loadMenuItemsFromFirebase();
            updateCartCount();
            
            // Event listeners
            document.getElementById('adminBtn').addEventListener('click', openAdmin);
            document.getElementById('closeAdmin').addEventListener('click', closeAdmin);
            document.getElementById('menuForm').addEventListener('submit', addMenuItem);
            document.getElementById('viewCart').addEventListener('click', openCart);
            document.getElementById('closeCart').addEventListener('click', closeCart);
            document.getElementById('requestQuotation').addEventListener('click', requestQuotation);
            document.getElementById('addQuotationItem').addEventListener('click', addQuotationItem);
            document.getElementById('addFromMenu').addEventListener('click', addFromMenu);
            document.getElementById('generatePDF').addEventListener('click', generatePDF);
            
            // Quantity modal
            document.getElementById('cancelQty').addEventListener('click', closeQuantityModal);
            document.getElementById('confirmQty').addEventListener('click', confirmQuantity);
            document.getElementById('decreaseQty').addEventListener('click', () => adjustQuantity(-1));
            document.getElementById('increaseQty').addEventListener('click', () => adjustQuantity(1));
            
            // Edit modal
            document.getElementById('cancelEdit').addEventListener('click', closeEditModal);
            document.getElementById('editForm').addEventListener('submit', updateMenuItem);
            
            // Photo preview
            document.getElementById('itemPhoto').addEventListener('change', previewPhoto);
            document.getElementById('editItemPhoto').addEventListener('change', previewEditPhoto);
            document.getElementById('backgroundPhoto').addEventListener('change', previewBackgroundPhoto);
            
            // Background photo controls
            document.getElementById('uploadBackground').addEventListener('click', updateBackground);
            document.getElementById('resetBackground').addEventListener('click', resetBackground);

            // Category filters
            document.querySelectorAll('.category-filter').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.category-filter').forEach(b => {
                        b.classList.remove('active');
                    });
                    e.target.classList.add('active');
                    filterMenuItems(e.target.dataset.category);
                });
            });
        }

        function previewPhoto() {
            const file = document.getElementById('itemPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('previewImg').src = e.target.result;
                    document.getElementById('photoPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        function previewEditPhoto() {
            const file = document.getElementById('editItemPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('editPreviewImg').src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function previewBackgroundPhoto() {
            const file = document.getElementById('backgroundPhoto').files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('backgroundPreviewImg').src = e.target.result;
                    document.getElementById('backgroundPreview').classList.remove('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        async function updateBackground() {
            const file = document.getElementById('backgroundPhoto').files[0];
            if (!file) {
                alert('Please select a background image first');
                return;
            }

            const btn = document.getElementById('uploadBackground');
            const originalText = btn.textContent;
            
            try {
                btn.textContent = 'Uploading...';
                btn.disabled = true;
                
                // Upload to Firebase Storage
                const imagePath = `backgrounds/background_${Date.now()}_${file.name}`;
                const imageUrl = await uploadImageToFirebase(file, imagePath);
                
                // Update body background with the uploaded image
                document.body.style.backgroundImage = `linear-gradient(135deg, rgba(248, 249, 250, 0.85) 0%, rgba(233, 236, 239, 0.85) 100%), url('${imageUrl}')`;
                document.body.style.backgroundSize = 'cover';
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundAttachment = 'fixed';
                
                // Store in Firebase Database
                await database.ref('settings/backgroundImage').set(imageUrl);
                
                // Show success message
                btn.textContent = 'Background Updated!';
                btn.classList.remove('luxury-button');
                btn.classList.add('bg-green-600');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.add('luxury-button');
                    btn.classList.remove('bg-green-600');
                    btn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error updating background:', error);
                alert('Error updating background. Please try again.');
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        async function resetBackground() {
            const btn = document.getElementById('resetBackground');
            const originalText = btn.textContent;
            
            try {
                btn.textContent = 'Resetting...';
                btn.disabled = true;
                
                // Reset to default background
                document.body.style.backgroundImage = `linear-gradient(135deg, rgba(248, 249, 250, 0.95) 0%, rgba(233, 236, 239, 0.95) 100%), 
                            url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyMCIgaGVpZ2h0PSIxMDgwIiB2aWV3Qm94PSIwIDAgMTkyMCAxMDgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZGVmcz4KPHN0eWxlPgouYmFja2dyb3VuZCB7CiAgZmlsbDogbGluZWFyLWdyYWRpZW50KDEzNWRlZywgIzFhMWEyZSAwJSwgIzE2MjEzZSAxMDAlKTsKfQouY29va2luZy1zY2VuZSB7CiAgZmlsbDogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjEpOwogIHN0cm9rZTogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjMpOwogIHN0cm9rZS13aWR0aDogMjsKfQouZmFkZWQgewogIG9wYWNpdHk6IDAuMzsKfQo8L3N0eWxlPgo8L2RlZnM+CjxyZWN0IHdpZHRoPSIxOTIwIiBoZWlnaHQ9IjEwODAiIGNsYXNzPSJiYWNrZ3JvdW5kIi8+CjwhLS0gS2l0Y2hlbiBDb3VudGVyIC0tPgo8cmVjdCB4PSIxMDAiIHk9IjcwMCIgd2lkdGg9IjE3MjAiIGhlaWdodD0iMjAwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgcng9IjIwIi8+CjwhLS0gQ29va2luZyBQb3RzIC0tPgo8Y2lyY2xlIGN4PSIzMDAiIGN5PSI2NTAiIHI9IjgwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8Y2lyY2xlIGN4PSI2MDAiIGN5PSI2MDAiIHI9IjEwMCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSI5MDAiIGN5PSI2MjAiIHJ4PSIxMjAiIHJ5PSI4MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBTcGljZSBCb3dscy0tPgo8Y2lyY2xlIGN4PSIxMjAwIiBjeT0iNjgwIiByPSI0MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxMzUwIiBjeT0iNjkwIiByeD0iNTAiIHJ5PSIzMCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxNTAwIiBjeT0iNjcwIiByeD0iNDUiIHJ5PSIzNSIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBXb21lbiBGaWd1cmVzIC0tPgo8ZWxsaXBzZSBjeD0iNDAwIiBjeT0iNTAwIiByeD0iNDAiIHJ5PSI4MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSI4MDAiIGN5PSI0ODAiIHJ4PSI0NSIgcnk9Ijg1IiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8ZWxsaXBzZSBjeD0iMTIwMCIgY3k9IjQ2MCIgcng9IjQyIiByeT0iODIiIGNsYXNzPSJjb29raW5nLXNjZW5lIGZhZGVkIi8+CjwhLS0gSGVhZHNjYXJmcyAtLT4KPGV4bGxpcHNlIGN4PSI0MDAiIGN5PSI0MDAiIHJ4PSI1MCIgcnk9IjMwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIvPgo8ZWxsaXBzZSBjeD0iODAwIiBjeT0iMzgwIiByeD0iNTUiIHJ5PSIzMiIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPGV4bGxpcHNlIGN4PSIxMjAwIiBjeT0iMzYwIiByeD0iNTIiIHJ5PSIzMSIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiLz4KPCEtLSBTdGVhbSBmcm9tIENvb2tpbmcgLS0+CjxwYXRoIGQ9Ik0zMDAgNTUwIFEzMjAgNTIwIDM0MCA1NTAgUTM2MCA1MjAgMzgwIDU1MCIgY2xhc3M9ImNvb2tpbmctc2NlbmUgZmFkZWQiIGZpbGw9Im5vbmUiLz4KPHA+dGggZD0iTTYwMCA1MDAgUTYzMCA0NzAgNjYwIDUwMCBRNjkwIDQ3MCA3MjAgNTAwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgZmlsbD0ibm9uZSIvPgo8cGF0aCBkPSJNOTAwIDUyMCBROTMwIDQ5MCA5NjAgNTIwIFE5OTAgNDkwIDEwMjAgNTIwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgZmlsbD0ibm9uZSIvPgo8IS0tIERlY29yYXRpdmUgRWxlbWVudHMgLS0+CjxyZWN0IHg9IjUwIiB5PSI4MDAiIHdpZHRoPSIxODIwIiBoZWlnaHQ9IjEwIiBjbGFzcz0iY29va2luZy1zY2VuZSBmYWRlZCIgcng9IjUiLz4KPHN2Zz4=')`;
                
                // Remove from Firebase
                await database.ref('settings/backgroundImage').remove();
                
                // Clear the file input and preview
                document.getElementById('backgroundPhoto').value = '';
                document.getElementById('backgroundPreview').classList.add('hidden');
                
                // Show success message
                btn.textContent = 'Reset Complete!';
                btn.classList.remove('gold-button');
                btn.classList.add('bg-green-600');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.classList.add('gold-button');
                    btn.classList.remove('bg-green-600');
                    btn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error resetting background:', error);
                alert('Error resetting background. Please try again.');
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        function loadSavedBackground() {
            // Load background from Firebase
            database.ref('settings/backgroundImage').once('value', (snapshot) => {
                const backgroundUrl = snapshot.val();
                if (backgroundUrl) {
                    document.body.style.backgroundImage = `linear-gradient(135deg, rgba(248, 249, 250, 0.85) 0%, rgba(233, 236, 239, 0.85) 100%), url('${backgroundUrl}')`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundAttachment = 'fixed';
                }
            }).catch((error) => {
                console.error('Error loading background:', error);
            });
        }

        function openAdmin() {
            document.getElementById('adminModal').classList.remove('hidden');
        }

        function closeAdmin() {
            document.getElementById('adminModal').classList.add('hidden');
        }

        async function addMenuItem(e) {
            e.preventDefault();
            const btn = document.querySelector('#menuForm button[type="submit"]');
            const originalText = btn.textContent;
            
            try {
                btn.innerHTML = '<div class="flex items-center justify-center gap-2"><div class="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>Adding...</div>';
                btn.disabled = true;
                
                const photoFile = document.getElementById('itemPhoto').files[0];
                let imageData = 'üçΩÔ∏è';
                
                if (photoFile) {
                    // Upload image to Firebase Storage
                    const imagePath = `menu-images/${Date.now()}_${photoFile.name}`;
                    imageData = await uploadImageToFirebase(photoFile, imagePath);
                }
                
                const newItem = {
                    name: document.getElementById('itemName').value,
                    description: document.getElementById('itemDescription').value,
                    category: document.getElementById('itemCategory').value,
                    image: imageData,
                    createdAt: Date.now()
                };
                
                await saveMenuItemToFirebase(newItem);
                
                document.getElementById('menuForm').reset();
                document.getElementById('photoPreview').classList.add('hidden');
                
                // Show success message
                btn.innerHTML = '‚úì Added Successfully!';
                btn.classList.remove('luxury-button');
                btn.classList.add('bg-green-600');
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.add('luxury-button');
                    btn.classList.remove('bg-green-600');
                    btn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error adding menu item:', error);
                alert('Error adding menu item. Please try again.');
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }

        function renderMenuItems() {
            const container = document.getElementById('menuItems');
            container.innerHTML = menuItems.map(item => `
                <div class="menu-card rounded-3xl p-4 sm:p-6 luxury-shadow" data-category="${item.category}">
                    <div class="flex flex-col sm:flex-row gap-4">
                        <div class="w-24 h-24 sm:w-32 sm:h-32 flex-shrink-0 mx-auto sm:mx-0">
                            ${item.image.startsWith('data:') ? 
                                `<img src="${item.image}" alt="${item.name}" class="w-24 h-24 sm:w-32 sm:h-32 object-cover rounded-2xl luxury-shadow">` : 
                                `<div class="w-24 h-24 sm:w-32 sm:h-32 flex items-center justify-center text-4xl sm:text-5xl luxury-gradient rounded-2xl text-white">${item.image}</div>`
                            }
                        </div>
                        <div class="flex-1 text-center sm:text-left">
                            <h3 class="font-semibold text-gray-800 mb-2 text-base sm:text-lg malayalam-text">${item.name}</h3>
                            <p class="text-gray-600 text-xs sm:text-sm mb-4 leading-relaxed malayalam-text">${item.description}</p>
                            <button onclick="openQuantityModal('${item.id}')" class="luxury-button text-white px-4 sm:px-6 py-2 sm:py-3 rounded-2xl font-medium w-full sm:w-auto">Add to Cart</button>
                        </div>
                    </div>
                </div>
            `).join('');
            updateMenuSelector();
        }

        function renderAdminMenu() {
            const container = document.getElementById('adminMenuList');
            container.innerHTML = menuItems.map(item => `
                <div class="flex justify-between items-center p-4 glass-effect rounded-2xl">
                    <div class="flex gap-4 items-center">
                        <div class="w-14 h-14">
                            ${item.image.startsWith('data:') ? 
                                `<img src="${item.image}" alt="${item.name}" class="w-14 h-14 object-cover rounded-2xl">` : 
                                `<div class="w-14 h-14 flex items-center justify-center text-2xl luxury-gradient rounded-2xl text-white">${item.image}</div>`
                            }
                        </div>
                        <div>
                            <div class="font-semibold text-gray-800 malayalam-text">${item.name}</div>
                            <div class="text-sm text-gray-600 capitalize">${item.category}</div>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="editMenuItem('${item.id}')" class="luxury-button text-white px-4 py-2 rounded-xl text-sm">Edit</button>
                        <button onclick="deleteMenuItem('${item.id}')" class="gold-button text-white px-4 py-2 rounded-xl text-sm">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function openQuantityModal(itemId) {
            selectedItemForQuantity = itemId;
            const item = menuItems.find(i => i.id === itemId);
            const nameElement = document.getElementById('selectedItemName');
            nameElement.textContent = item.name;
            nameElement.classList.add('malayalam-text');
            document.getElementById('quantityInput').value = 1;
            document.getElementById('quantityModal').classList.remove('hidden');
        }

        function closeQuantityModal() {
            document.getElementById('quantityModal').classList.add('hidden');
            selectedItemForQuantity = null;
        }

        function adjustQuantity(change) {
            const input = document.getElementById('quantityInput');
            const newValue = parseInt(input.value) + change;
            if (newValue >= 1) {
                input.value = newValue;
            }
        }

        function confirmQuantity() {
            const quantity = parseInt(document.getElementById('quantityInput').value);
            const item = menuItems.find(i => i.id === selectedItemForQuantity);
            const existingItem = cart.find(i => i.id === selectedItemForQuantity);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                cart.push({...item, quantity: quantity});
            }
            
            updateCartCount();
            closeQuantityModal();
            
            // Show success message
            const toast = document.createElement('div');
            toast.className = 'fixed top-20 right-4 bg-green-600 text-white px-4 py-2 rounded-lg z-50';
            toast.textContent = `Added ${quantity} ${item.name} to cart!`;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        function editMenuItem(itemId) {
            const item = menuItems.find(i => i.id === itemId);
            document.getElementById('editItemId').value = item.id;
            document.getElementById('editItemName').value = item.name;
            document.getElementById('editItemDescription').value = item.description;
            document.getElementById('editItemCategory').value = item.category;
            
            if (item.image.startsWith('data:')) {
                document.getElementById('editPreviewImg').src = item.image;
            } else {
                document.getElementById('editPreviewImg').src = '';
            }
            
            document.getElementById('editModal').classList.remove('hidden');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
        }

        async function updateMenuItem(e) {
            e.preventDefault();
            const btn = document.querySelector('#editForm button[type="submit"]');
            const originalText = btn.textContent;
            
            try {
                btn.textContent = 'Updating...';
                btn.disabled = true;
                
                const itemId = document.getElementById('editItemId').value;
                const currentItem = menuItems.find(i => i.id === itemId);
                const photoFile = document.getElementById('editItemPhoto').files[0];
                
                let imageData = currentItem.image; // Keep existing image by default
                
                if (photoFile) {
                    // Upload new image to Firebase Storage
                    const imagePath = `menu-images/${Date.now()}_${photoFile.name}`;
                    imageData = await uploadImageToFirebase(photoFile, imagePath);
                }
                
                const updatedItem = {
                    name: document.getElementById('editItemName').value,
                    description: document.getElementById('editItemDescription').value,
                    category: document.getElementById('editItemCategory').value,
                    image: imageData,
                    createdAt: currentItem.createdAt || Date.now(),
                    updatedAt: Date.now()
                };
                
                await updateMenuItemInFirebase(itemId, updatedItem);
                closeEditModal();
                
            } catch (error) {
                console.error('Error updating menu item:', error);
                alert('Error updating menu item. Please try again.');
                btn.textContent = originalText;
                btn.disabled = false;
            }
        }

        async function deleteMenuItem(itemId) {
            if (confirm('Are you sure you want to delete this item?')) {
                try {
                    await deleteMenuItemFromFirebase(itemId);
                    // The UI will update automatically through the Firebase listener
                } catch (error) {
                    console.error('Error deleting menu item:', error);
                    alert('Error deleting menu item. Please try again.');
                }
            }
        }

        function filterMenuItems(category) {
            const items = document.querySelectorAll('.menu-card');
            items.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        function openCart() {
            renderCartItems();
            document.getElementById('cartModal').classList.remove('hidden');
        }

        function closeCart() {
            document.getElementById('cartModal').classList.add('hidden');
        }

        function renderCartItems() {
            const container = document.getElementById('cartItems');
            if (cart.length === 0) {
                container.innerHTML = '<div class="text-center py-12"><div class="text-6xl mb-4">üõí</div><p class="text-gray-500 text-lg">Your cart is empty</p></div>';
                return;
            }
            
            container.innerHTML = cart.map(item => `
                <div class="flex justify-between items-center p-4 glass-effect rounded-2xl">
                    <div class="flex gap-4 items-center">
                        <div class="w-14 h-14">
                            ${item.image.startsWith('data:') ? 
                                `<img src="${item.image}" alt="${item.name}" class="w-14 h-14 object-cover rounded-2xl">` : 
                                `<div class="w-14 h-14 flex items-center justify-center text-2xl luxury-gradient rounded-2xl text-white">${item.image}</div>`
                            }
                        </div>
                        <div>
                            <div class="font-semibold text-gray-800 malayalam-text">${item.name}</div>
                            <div class="text-sm text-gray-600">Quantity: ${item.quantity}</div>
                        </div>
                    </div>
                    <button onclick="removeFromCart('${item.id}')" class="gold-button text-white px-4 py-2 rounded-xl text-sm">Remove</button>
                </div>
            `).join('');
        }

        function removeFromCart(itemId) {
            cart = cart.filter(i => i.id !== itemId);
            updateCartCount();
            renderCartItems();
        }

        function requestQuotation() {
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            const cartText = cart.map(item => `${item.name} (Qty: ${item.quantity})`).join('\n');
            const message = `Hello SPICY KITCHEN! üçΩÔ∏è\n\nI would like to request a quotation for the following party food items:\n\n${cartText}\n\nPlease provide pricing and delivery details.\n\nThank you!`;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function updateMenuSelector() {
            const select = document.getElementById('menuItemSelect');
            select.innerHTML = '<option value="">Select from menu</option>' + 
                menuItems.map(item => `<option value="${item.id}">${item.name}</option>`).join('');
        }

        function addFromMenu() {
            const select = document.getElementById('menuItemSelect');
            const selectedId = select.value;
            if (!selectedId) return;
            
            const item = menuItems.find(i => i.id == selectedId);
            const container = document.getElementById('quotationItems');
            const itemDiv = document.createElement('div');
            itemDiv.className = 'flex gap-3';
            itemDiv.innerHTML = `
                <input type="text" value="${item.name}" class="flex-1 p-3 input-luxury rounded-2xl focus:outline-none malayalam-text">
                <input type="number" placeholder="Qty" class="w-20 p-3 input-luxury rounded-2xl focus:outline-none" value="1">
                <input type="number" placeholder="Price" class="w-24 p-3 input-luxury rounded-2xl focus:outline-none">
                <button onclick="this.parentElement.remove()" class="gold-button text-white px-4 py-3 rounded-2xl">√ó</button>
            `;
            container.appendChild(itemDiv);
            select.value = '';
        }

        function addQuotationItem() {
            const container = document.getElementById('quotationItems');
            const itemDiv = document.createElement('div');
            itemDiv.className = 'flex gap-3';
            itemDiv.innerHTML = `
                <input type="text" placeholder="Item name" class="flex-1 p-3 input-luxury rounded-2xl focus:outline-none">
                <input type="number" placeholder="Qty" class="w-20 p-3 input-luxury rounded-2xl focus:outline-none">
                <input type="number" placeholder="Price" class="w-24 p-3 input-luxury rounded-2xl focus:outline-none">
                <button onclick="this.parentElement.remove()" class="gold-button text-white px-4 py-3 rounded-2xl">√ó</button>
            `;
            container.appendChild(itemDiv);
        }

        function generatePDF() {
            const customerName = document.getElementById('customerName').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const deliveryAddress = document.getElementById('deliveryAddress').value;
            const deliveryCharge = parseFloat(document.getElementById('deliveryCharge').value) || 0;
            
            if (!customerName || !customerPhone) {
                alert('Please enter customer name and phone number');
                return;
            }

            const quotationItems = Array.from(document.getElementById('quotationItems').children).map(item => {
                const inputs = item.querySelectorAll('input');
                return {
                    name: inputs[0].value,
                    quantity: inputs[1].value,
                    price: inputs[2].value
                };
            }).filter(item => item.name && item.quantity && item.price);

            if (quotationItems.length === 0) {
                alert('Please add at least one item to the quotation');
                return;
            }

            // Generate PDF using jsPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Enhanced Header with Branding
            doc.setFillColor(48, 151, 116);
            doc.rect(0, 0, 210, 50, 'F');
            
            doc.setFontSize(24);
            doc.setTextColor(255, 255, 255);
            doc.text('üçΩÔ∏è SPICY KITCHEN', 20, 25);
            
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text('Passion Served with Spice - ‡¥µ‡¥≥‡¥™‡¥ü‡µç‡¥ü‡¥£‡¥Ç', 20, 35);
            doc.text('Serving inside Kannur only', 20, 42);
            
            // Quotation Title
            doc.setFontSize(18);
            doc.setTextColor(48, 151, 116);
            doc.text('QUOTATION', 20, 65);
            
            // Quotation Number and Date
            const quotationNo = `QT${Date.now().toString().slice(-6)}`;
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.text(`Quotation No: ${quotationNo}`, 140, 65);
            doc.text(`Date: ${new Date().toLocaleDateString()}`, 140, 72);
            
            // Customer details box
            doc.setDrawColor(48, 151, 116);
            doc.setLineWidth(0.5);
            doc.rect(20, 80, 170, 35);
            
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text('CUSTOMER DETAILS:', 25, 90);
            doc.setFontSize(10);
            doc.text(`Name: ${customerName}`, 25, 98);
            doc.text(`Phone: ${customerPhone}`, 25, 105);
            if (deliveryAddress) {
                doc.text(`Delivery Address: ${deliveryAddress}`, 25, 112);
            }
            
            // Items table header
            let yPos = 130;
            doc.setFillColor(48, 151, 116);
            doc.rect(20, yPos, 170, 10, 'F');
            
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('ITEM DESCRIPTION', 25, yPos + 7);
            doc.text('QTY', 110, yPos + 7);
            doc.text('RATE (‚Çπ)', 130, yPos + 7);
            doc.text('AMOUNT (‚Çπ)', 160, yPos + 7);
            
            yPos += 15;
            doc.setTextColor(0, 0, 0);
            
            let grandTotal = 0;
            quotationItems.forEach((item, index) => {
                const total = parseFloat(item.quantity) * parseFloat(item.price);
                grandTotal += total;
                
                // Alternate row colors
                if (index % 2 === 0) {
                    doc.setFillColor(245, 247, 250);
                    doc.rect(20, yPos - 5, 170, 10, 'F');
                }
                
                doc.setFontSize(9);
                doc.text(item.name.substring(0, 35), 25, yPos);
                doc.text(item.quantity.toString(), 115, yPos);
                doc.text(`‚Çπ${parseFloat(item.price).toFixed(2)}`, 135, yPos);
                doc.text(`‚Çπ${total.toFixed(2)}`, 165, yPos);
                yPos += 10;
            });
            
            // Delivery charge
            if (deliveryCharge > 0) {
                yPos += 5;
                doc.setFontSize(10);
                doc.text('Delivery Charge:', 130, yPos);
                doc.text(`‚Çπ${deliveryCharge.toFixed(2)}`, 165, yPos);
                grandTotal += deliveryCharge;
                yPos += 10;
            }
            
            // Total section
            yPos += 5;
            doc.setFillColor(48, 151, 116);
            doc.rect(120, yPos - 5, 70, 15, 'F');
            doc.setFontSize(12);
            doc.setTextColor(255, 255, 255);
            doc.text(`TOTAL: ‚Çπ${grandTotal.toFixed(2)}`, 130, yPos + 5);
            
            // Terms and conditions
            yPos += 25;
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            doc.text('TERMS & CONDITIONS:', 20, yPos);
            doc.setFontSize(8);
            doc.text('‚Ä¢ Advance payment required for order confirmation', 20, yPos + 8);
            doc.text('‚Ä¢ Delivery charges may vary based on location within Kannur', 20, yPos + 15);
            doc.text('‚Ä¢ Menu items subject to availability', 20, yPos + 22);
            doc.text('‚Ä¢ Prices are inclusive of all taxes', 20, yPos + 29);
            
            // Footer
            yPos += 45;
            doc.setFillColor(48, 151, 116);
            doc.rect(0, yPos, 210, 25, 'F');
            
            doc.setFontSize(10);
            doc.setTextColor(255, 255, 255);
            doc.text('Thank you for choosing SPICY KITCHEN!', 20, yPos + 8);
            doc.text('üçΩÔ∏è A fully home made solution for your party üçΩÔ∏è - ‡¥µ‡¥≥‡¥™‡¥ü‡µç‡¥ü‡¥£‡¥Ç', 20, yPos + 16);
            doc.text('Contact: +91-XXXXXXXXXX | Email: info@spicykitchen.com', 20, yPos + 22);
            
            // Download PDF
            doc.save(`SPICY_KITCHEN_Quotation_${quotationNo}_${customerName.replace(/\s+/g, '_')}.pdf`);
            
            // Show success message
            const btn = document.getElementById('generatePDF');
            const originalText = btn.textContent;
            btn.textContent = 'PDF Downloaded Successfully!';
            btn.classList.remove('gold-button');
            btn.classList.add('bg-green-600');
            setTimeout(() => {
                btn.textContent = originalText;
                btn.classList.add('gold-button');
                btn.classList.remove('bg-green-600');
            }, 3000);
        }

        // Initialize the app
        init();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9753c08f6180f9ec',t:'MTc1NjIxNTc0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
